<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width initial-scale=1" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  

  
  

  
  
  
  
  

  <title>M2M-100</title>
  <meta name="title" content="M2M-100">
  <meta name="description" content="M2M stands for “Many-to-Many” which is a multilingual NMT model using
many-to-many datasets. The model was created by Facebook AI in 2020 and
published in their paper: “Beyond English-Centric Multilingual Machine
Translation”. The official code
for this paper can be found on the official FairSeq repository:
m2m_100

">
  <meta name="author" content="Phanxuan Phuc">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  <!-- Google / Search Engine Tags -->
  <meta itemprop="name" content="M2M-100">
  <meta itemprop="description" content="M2M stands for “Many-to-Many” which is a multilingual NMT model using
many-to-many datasets. The model was created by Facebook AI in 2020 and
published in their paper: “Beyond English-Centric Multilingual Machine
Translation”. The official code
for this paper can be found on the official FairSeq repository:
m2m_100

">
  <meta itemprop="image" content="/multilingual-nmt/media/M2M-100/image1.png">

  <!-- OpenGraph Meta Tags -->
  <meta property="og:url" content="http://localhost:4000">
  <meta property="og:type" content="article">
  <meta property="og:site_name" content="Phuc Phan's Blog"/>
  <meta property="og:title" content="M2M-100">
  <meta property="og:description" content="M2M stands for “Many-to-Many” which is a multilingual NMT model using
many-to-many datasets. The model was created by Facebook AI in 2020 and
published in their paper: “Beyond English-Centric Multilingual Machine
Translation”. The official code
for this paper can be found on the official FairSeq repository:
m2m_100

">
  <meta property="og:image" content="/multilingual-nmt/media/M2M-100/image1.png">

  <!-- Twitter Meta Tags -->
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="M2M-100">
  <meta name="twitter:description" content="M2M stands for “Many-to-Many” which is a multilingual NMT model using
many-to-many datasets. The model was created by Facebook AI in 2020 and
published in their paper: “Beyond English-Centric Multilingual Machine
Translation”. The official code
for this paper can be found on the official FairSeq repository:
m2m_100

">
  
  <meta name="twitter:image" content="/multilingual-nmt/media/M2M-100/image1.png">

  <link rel="apple-touch-icon" sizes="57x57" href="/images/favicons/apple-touch-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/images/favicons/apple-touch-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/images/favicons/apple-touch-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/images/favicons/apple-touch-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/images/favicons/apple-touch-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/images/favicons/apple-touch-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/images/favicons/apple-touch-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/favicons/apple-touch-icon-180x180.png">
  <link rel="icon" type="image/png" href="/images/favicons/favicon-16x16.png" sizes="16x16">
  <link rel="icon" type="image/png" href="/images/favicons/favicon-32x32.png" sizes="32x32">
  <link rel="icon" type="image/png" href="/images/favicons/favicon-96x96.png" sizes="96x96">
  <link rel="icon" type="image/png" href="/images/favicons/favicon-196x196.png" sizes="196x196">
  <link rel="icon" type="image/png" href="/images/favicons/android-chrome-194x194.png" sizes="194x194">
  <link rel="icon" type="image/png" href="/images/favicons/android-chrome-512x512.png" sizes="512x512">
  <link rel="manifest" href="/images/favicons/manifest.json">
  <link rel="shortcut icon" href="/images/favicons/favicon.ico">
  <meta name="msapplication-TileColor" content="#ffc40d">
  <meta name="msapplication-TileImage" content="/images/favicons/mstile-144x144.png">
  <meta name="msapplication-square70x70logo" content="/images/favicons/mstile-70x70.png" />
  <meta name="msapplication-square150x150logo" content="/images/favicons/mstile-150x150.png" />
  <meta name="msapplication-wide310x150logo" content="/images/favicons/mstile-310x150.png" />
  <meta name="msapplication-square310x310logo" content="/images/favicons/mstile-310x310.png" />
  <meta name="theme-color" content="#ffffff">
  
  <link rel="stylesheet" href="/css/main.css?1680763441293376118">
  <link rel="canonical" href="http://localhost:4000/multilingual-nmt/M2M-100">
  <link rel="alternate" type="application/rss+xml" title="Phuc Phan's Blog" href="/feed.xml">
  <script type="text/javascript" src="/js/jquery.v3.3.1.min.js"></script>
  <!-- <script type="text/javascript" src="/js/simple-jekyll-search.min.js"></script> -->
  <script type="text/javascript" src="/js/simple-blog-search.min.js"></script>
</head>

  <body>
    <span class="mobile btn-mobile-menu">
  <i class="extra-big-icon iconify-inline icon-list btn-mobile-menu__icon" data-icon="gg:menu-round"></i>
  <i class="extra-big-icon iconify-inline icon-x-circle btn-mobile-close__icon hidden" data-icon="ion:close-circle-outline"></i>
</span>

<header class="panel-cover "
  style="background-image: url(/images/forest.jpg)">
  <div class="panel-main panel-cover--overlay">

    <div class="panel-main__inner panel-inverted">
      <div class="panel-main__content">
        <img src="/images/avatar.jpg" class="user-image"
        onmouseover="this.src='/images/avatar-light.jpg';"
        onmouseout="this.src='/images/avatar.jpg';">
        <h1 class="panel-cover__title panel-title">
          <a href="/">Phanxuan Phuc</a>
        </h1>
        </a>
        <h6 class="panel-cover__title panel-subtitle">fakerphan
          <i class="medium-icon iconify-inline" data-icon="foundation:male-symbol"></i>
        </h6>
        <nav class="cover-navigation navigation--social">
    <ul class="navigation">

      
      <!-- Email -->
      <li class="navigation__item">
        <a href="mailto:phanxuanphucnd@gmail.com" target="_blank" title="Email">
          <i class="big-icon iconify-inline" data-icon="fluent:mail-copy-24-filled"></i>
        </a>
      </li>
      

      
      <!-- LinkedIn -->
      <li class="navigation__item">
        <a href="https://www.linkedin.com/in/phanxuanphucnd" target="_blank" title="LinkedIn">
          <i class="big-icon iconify-inline" data-icon="akar-icons:linkedin-fill"></i>
        </a>
      </li>
      

      
      <!-- GitHub -->
      <li class="navigation__item">
        <a href="https://www.github.com/phanxuanphucnd" target="_blank" title="GitHub">
          <i class="big-icon iconify-inline" data-icon="akar-icons:github-fill"></i>
        </a>
      </li>
      

      <li class="navigation__item">
        <a href="https://scholar.google.com/citations?user=ipcDPCQAAAAJ&hl=vi" title="Google Scholar" target="_blank">
          <i class="big-icon iconify-inline" data-icon="mdi:google"></i>
          <!-- <span class="label">RSS</span> -->
        </a>
      </li>

      <li class="navigation__item">
        <a href="https://www.facebook.com/phanxuanphucnd" title="Facebook" target="_blank">
          <i class="big-icon iconify-inline" data-icon="ic:outline-facebook"></i>
          <!-- <span class="label">RSS</span> -->
        </a>
      </li>
    </ul>
  </nav>
        
        <form class="search-container" onsubmit="return searchTheArchives()" >
          <input type="search" id="search-input" placeholder="Search.." autocomplete="off" style="padding-right: 40px;">
        </form>

        <hr class="panel-cover__divider panel-cover__divider--secondary">
        
        <div class="navigation-wrapper">
          <p class="panel-cover__description">I’m a AI Engineer in Vin Bigdata. And I summarize research papers in these topics:</p>
          <nav class="cover-navigation cover-navigation--primary">
            <ul class="navigation">
              
              
              <li class="navigation__item">
                <a href="/cross-lingual-lm" class="blog-button" id="cross-lingual-lm"
                onclick="activateButton(this.id)">Cross-lingual Langluage Model</a>
              </li>
              
              
              
              <li class="navigation__item">
                <a href="/language-modeling" class="blog-button" id="language-modeling"
                onclick="activateButton(this.id)">Language Modeling</a>
              </li>
              
              
              
              <li class="navigation__item">
                <a href="/machine-translation" class="blog-button" id="machine-translation"
                onclick="activateButton(this.id)">Machine Translation</a>
              </li>
              
              
              
              
              
              <li class="navigation__item">
                <a href="/multilingual-nmt" class="blog-button" id="multilingual-nmt"
                onclick="activateButton(this.id)">Multilingual NMT</a>
              </li>
              
              
              
              
              
              
            </ul>
          </nav>
        </div>
        
        <hr class="panel-cover__divider">
      </div>

    </div>

    <!-- <div class="panel-cover--overlay"></div> -->
  </div>
</header>

    <div class="content-wrapper">
      <div class="content-wrapper__inner">
        <article class="post-container post-container--single">
  <header class="post-header">
    <div class="post-meta">
      <p class="post-meta__body">
        <i class="medium-icon iconify-inline" data-icon="bi:clock-history"></i>
        <span id="reading-time">
          
          4 mins read
        </span>
      </p>
      <time datetime="2020-10-21 00:00" class="post-meta__body date">Published on arXiv on: 21 Oct 2020</time>
      
      <p class="post-meta__tags">Published by: <a href="/labs/#FAIR">FAIR</a> & <a href="/labs/#LORIA">LORIA</a></p>
      
    </div>
  </header>

  <section class="post">
    <h1 id=M2M-100> M2M-100</h1>
    <p>M2M stands for “Many-to-Many” which is a multilingual NMT model using
many-to-many datasets. The model was created by Facebook AI in 2020 and
published in their paper: “<a href="https://arxiv.org/pdf/2010.11125.pdf">Beyond English-Centric Multilingual Machine
Translation</a>”. The official code
for this paper can be found on the official FairSeq repository:
<a href="https://github.com/pytorch/fairseq/tree/main/examples/m2m_100">m2m_100</a></p>

<p>Since multilingual NMT models are hungry for data and the most
resourceful language currently is English, most of the existing
multilingual NMT models use data either translated from or to English.
This English-Centric bias in the data results in models not reflective
of how people use translation and empirically leads to lower performance
for non-English translation directions. M2M model is considered a true
Many-to-Many multilingual translation model that can translate directly
between any pair of 100 languages.</p>

<p>Our focus on non-English-Centric models brings gains of more than 10
BLEU when directly translating between non-English directions while
performing competitively to the best single systems of WMT.</p>

<h2 id="architecture">Architecture</h2>

<p>M2M is basically a a large Transformer sequence-to-sequence model, which is
composed of two modules: 12-layer encoder and 12-layer decoder. It contains 8192 Feed-Forward-Network size and 1024 embedding dimension. The weight matrices of
the input and output embeddings. The total parameter count is 1.2B.</p>

<p>The encoder takes the sequence of tokens
$W = \left( w_{1},\ …w_{S} \right)$ and the source language $l_{s}$
and produces a sequence of embeddings of the same length
$H = \left( h_{1},\ …h_{S} \right)$:</p>

\[H = \text{encoder}\left( W,\ l_{s} \right)\]

<p>Then, the decoder is fed the sequence of embeddings $H$ with the target
language $l_{t}$ and sequentially produces the target sentence token by
token $V = \left( v_{1},\ …v_{S} \right)$:</p>

\[v_{i + 1} = \text{decoder}\left( H,\ l_{t},\ v_{1}\text{...}v_{i} \right)\]

<p>The Transformer architecture has been designed for the bilingual case,
where the target language is fixed. In the case of multilingual machine
translation, the target language is not fixed, so they added a special
token in the encoder indicating the source language $l_{s}$ and a
special token in the decoder indicating the target language $l_{t}$.</p>

<div align="center">
    <img src="media/M2M-100/image2.png" width="750" />
</div>

<p>The model is trained with the Adam optimizer and warmed-up first for
4000 updates, with label smoothing 0.1. For regularization, the dropout
parameter is tuned between {0.1, 0.2, 0.3}. To stabilize the training of
deeper Transformers, it is trained with LayerDrop 0.05 and
pre-normalization.</p>

<p>To train M2M, they used SentencePiece as a subword tokenizer. And since
SentencePiece produces subword units depending on their frequency in the
training dataset which would favor high-resource languages, they decided
to add monolingual data for low resource languages to compensate. Also,
they used a temperature sample which means that choosing language $l$
equals $p_{l}^{\frac{1}{T}}$. The following is the language distribution
of the vocabulary containing 128k token:</p>

<div align="center">
    <img src="media/M2M-100/image3.png" width="750" />
</div>

<h2 id="building-data">Building Data</h2>

<p>The superior performance of M2M-100 was achieved by building a
large-scale Many-to-Many dataset comprising 7.5B training sentences for
100 languages (you can find the full set of languages in page: 6 of the
paper). We considerably reduce the complexity of this task through the
automatic construction of parallel corpora with a novel data mining
strategy that exploits language similarity to avoid mining all
directions. We also leverage back-translation to improve the quality of
our model on zero-shot and low resource language pairs.</p>

<p>CHECK THE PAPER FOR MORE DETAILS REGARDING HOW THEY MINDED THE DATA.…
IT’S A LOT!!</p>

<h3 id="evaluation-set">Evaluation Set</h3>

<p>To cover their set of 100 languages and 2200 directions, they brought
together data from a variety of sources. We describe each evaluation
dataset below:</p>

<ul>
  <li>
    <p>WMT:<br />
The majority of language pairs from WMT go through English and the
data is from the news domain. We consider data for 13 languages.</p>
  </li>
  <li>
    <p>WAT:<br />
The WAT competition covers Asian languages paired with English.
They used it for Burmese-English.</p>
  </li>
  <li>
    <p>IWSLT:<br />
The IWSLT translation competition contains data from TED talks
paired with English translations. We use data for 4 languages.</p>
  </li>
  <li>
    <p>FLORES:<br />
FLORES pairs two low resource languages, Sinhala and Nepali, with
English in the Wikipedia domain.</p>
  </li>
  <li>
    <p>TED — The TED Talks dataset:<br />
It contains translations between more than 50 languages; most of
the pairs do not include English. The evaluation data is n-way
parallel and contains thousands of directions.</p>
  </li>
  <li>
    <p>Autshumato:<br />
Autshumato is an 11-way parallel dataset comprising 10 African
languages and English from the government domain.</p>
  </li>
  <li>
    <p>Tatoeba:<br />
Tatoeba Challenge covers 692 test pairs from mixed domains where
sentences are contributed and translated by volunteers online. The
evaluation pairs we use from Tatoeba cover 85 different languages.</p>
  </li>
</ul>

<h2 id="english-centric-bias">English-Centric Bias</h2>

<p>As said before, English-Centric multilingual models have some bias that
lowers their performance for non-English translation. To test that, they
trained the same architecture on the full 100 language Many-to-Many
dataset and on the English part of the data using the same vocabulary.
They trained the model for 500K updates which corresponds to one pass
over the entire Many-to-Many dataset and 3.5 passes on the
English-centric data.</p>

<p>Then, they compared the performance of both models on different types of
directions, namely, any language to English (To English), English to any
language (From English), and all the directions not involving English
(Non-English). And the following is the results averaging over all
directions:</p>

<div align="center">
    <img src="media/M2M-100/image4.png" width="450" />
</div>

<p>On the pairs including English, both models achieve similar performance.
For the non-English pairs, we consider two translation strategies for
the English-Centric model: directly translating as if the model was
trained on the pair – by using the corresponding language tokens – or
by pivoting through English. The M2M model outperforms direct
translation with the English-Centric model by 10.2 BLEU and when the
English-Centric model uses pivoting by 5.5 BLEU.</p>

<p>While this result is not surprising, it confirms that a purely
English-Centric model has limited potential on non-English pairs, and
there is a fundamental need for training on Many-to-Many data.</p>

<p>TO BE CONTINUED</p>

  </section>
</article>

  
  <br><br><br><br>
  <div id="disqus_thread"></div>
  <script type="text/javascript">
    var disqus_config = function () {
      this.page.url = 'http://localhost:4000/multilingual-nmt/M2M-100';
      this.page.identifier = '/multilingual-nmt/M2M-100';
    };

    (function() {
      var d = document, s = d.createElement('script');
      s.src = 'https://Phuc Phan.disqus.com/embed.js';
      s.setAttribute('data-timestamp', +new Date());
      (d.head || d.body).appendChild(s);
      })();
  </script>
  <noscript>
    Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a>
  </noscript>
  <!-- <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a> -->




      </div>
      
<footer class="footer">
  <!-- <span class="footer__copyright">&copy; 2023 Phanxuan Phuc. All rights reserved.</span> -->
  
  <!-- Adding Iconify -->
  <script src="https://code.iconify.design/2/2.0.3/iconify.min.js"></script>
  
  <!-- Adding MathJax -->
  <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      "tex2jax": {
        inlineMath: [['$','$']],
        processEscapes: true
      },
      "HTML-CSS": { linebreaks: { automatic: true } },
      "SVG": { linebreaks: { automatic: true } },
    });
  </script>
  
  <script type="text/javascript" async
    src="http://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-MML-AM_CHTML">
  </script>
  
  
  <!-- Adding main.js -->
  <script type="text/javascript" src="/js/main.js?1680763441293376118"></script>
  
  <!-- Adding Google Analytics -->
  
</footer>
    </div>
  </body>
</html>