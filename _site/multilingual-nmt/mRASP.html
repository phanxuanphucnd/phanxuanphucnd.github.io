<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width initial-scale=1" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  

  
  

  
  
  
  
  

  <title>mRASP</title>
  <meta name="title" content="mRASP">
  <meta name="description" content="mRASP stands for “multilingual Random Aligned Substitution Pre-training”
which is a pre-training method for multilingual NMT models proposed by
ByteDance AI Lab in 2020 and published in their paper: “Pre-training
Multilingual Neural Machine Translation by Leveraging Alignment
Information”. The official code
for this paper can be found on this GitHub repository:
mRASP.

">
  <meta name="author" content="Phanxuan Phuc">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  <!-- Google / Search Engine Tags -->
  <meta itemprop="name" content="mRASP">
  <meta itemprop="description" content="mRASP stands for “multilingual Random Aligned Substitution Pre-training”
which is a pre-training method for multilingual NMT models proposed by
ByteDance AI Lab in 2020 and published in their paper: “Pre-training
Multilingual Neural Machine Translation by Leveraging Alignment
Information”. The official code
for this paper can be found on this GitHub repository:
mRASP.

">
  <meta itemprop="image" content="/multilingual-nmt/media/mRASP/image0.png">

  <!-- OpenGraph Meta Tags -->
  <meta property="og:url" content="http://localhost:4000">
  <meta property="og:type" content="article">
  <meta property="og:site_name" content="Phuc Phan's Blog"/>
  <meta property="og:title" content="mRASP">
  <meta property="og:description" content="mRASP stands for “multilingual Random Aligned Substitution Pre-training”
which is a pre-training method for multilingual NMT models proposed by
ByteDance AI Lab in 2020 and published in their paper: “Pre-training
Multilingual Neural Machine Translation by Leveraging Alignment
Information”. The official code
for this paper can be found on this GitHub repository:
mRASP.

">
  <meta property="og:image" content="/multilingual-nmt/media/mRASP/image0.png">

  <!-- Twitter Meta Tags -->
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="mRASP">
  <meta name="twitter:description" content="mRASP stands for “multilingual Random Aligned Substitution Pre-training”
which is a pre-training method for multilingual NMT models proposed by
ByteDance AI Lab in 2020 and published in their paper: “Pre-training
Multilingual Neural Machine Translation by Leveraging Alignment
Information”. The official code
for this paper can be found on this GitHub repository:
mRASP.

">
  
  <meta name="twitter:image" content="/multilingual-nmt/media/mRASP/image0.png">

  <link rel="apple-touch-icon" sizes="57x57" href="/images/favicons/apple-touch-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/images/favicons/apple-touch-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/images/favicons/apple-touch-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/images/favicons/apple-touch-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/images/favicons/apple-touch-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/images/favicons/apple-touch-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/images/favicons/apple-touch-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/favicons/apple-touch-icon-180x180.png">
  <link rel="icon" type="image/png" href="/images/favicons/favicon-16x16.png" sizes="16x16">
  <link rel="icon" type="image/png" href="/images/favicons/favicon-32x32.png" sizes="32x32">
  <link rel="icon" type="image/png" href="/images/favicons/favicon-96x96.png" sizes="96x96">
  <link rel="icon" type="image/png" href="/images/favicons/favicon-196x196.png" sizes="196x196">
  <link rel="icon" type="image/png" href="/images/favicons/android-chrome-194x194.png" sizes="194x194">
  <link rel="icon" type="image/png" href="/images/favicons/android-chrome-512x512.png" sizes="512x512">
  <link rel="manifest" href="/images/favicons/manifest.json">
  <link rel="shortcut icon" href="/images/favicons/favicon.ico">
  <meta name="msapplication-TileColor" content="#ffc40d">
  <meta name="msapplication-TileImage" content="/images/favicons/mstile-144x144.png">
  <meta name="msapplication-square70x70logo" content="/images/favicons/mstile-70x70.png" />
  <meta name="msapplication-square150x150logo" content="/images/favicons/mstile-150x150.png" />
  <meta name="msapplication-wide310x150logo" content="/images/favicons/mstile-310x150.png" />
  <meta name="msapplication-square310x310logo" content="/images/favicons/mstile-310x310.png" />
  <meta name="theme-color" content="#ffffff">
  
  <link rel="stylesheet" href="/css/main.css?1680763441293376118">
  <link rel="canonical" href="http://localhost:4000/multilingual-nmt/mRASP">
  <link rel="alternate" type="application/rss+xml" title="Phuc Phan's Blog" href="/feed.xml">
  <script type="text/javascript" src="/js/jquery.v3.3.1.min.js"></script>
  <!-- <script type="text/javascript" src="/js/simple-jekyll-search.min.js"></script> -->
  <script type="text/javascript" src="/js/simple-blog-search.min.js"></script>
</head>

  <body>
    <span class="mobile btn-mobile-menu">
  <i class="extra-big-icon iconify-inline icon-list btn-mobile-menu__icon" data-icon="gg:menu-round"></i>
  <i class="extra-big-icon iconify-inline icon-x-circle btn-mobile-close__icon hidden" data-icon="ion:close-circle-outline"></i>
</span>

<header class="panel-cover "
  style="background-image: url(/images/forest.jpg)">
  <div class="panel-main panel-cover--overlay">

    <div class="panel-main__inner panel-inverted">
      <div class="panel-main__content">
        <img src="/images/avatar.jpg" class="user-image"
        onmouseover="this.src='/images/avatar-light.jpg';"
        onmouseout="this.src='/images/avatar.jpg';">
        <h1 class="panel-cover__title panel-title">
          <a href="/">Phanxuan Phuc</a>
        </h1>
        </a>
        <h6 class="panel-cover__title panel-subtitle">fakerphan
          <i class="medium-icon iconify-inline" data-icon="foundation:male-symbol"></i>
        </h6>
        <nav class="cover-navigation navigation--social">
    <ul class="navigation">

      
      <!-- Email -->
      <li class="navigation__item">
        <a href="mailto:phanxuanphucnd@gmail.com" target="_blank" title="Email">
          <i class="big-icon iconify-inline" data-icon="fluent:mail-copy-24-filled"></i>
        </a>
      </li>
      

      
      <!-- LinkedIn -->
      <li class="navigation__item">
        <a href="https://www.linkedin.com/in/phanxuanphucnd" target="_blank" title="LinkedIn">
          <i class="big-icon iconify-inline" data-icon="akar-icons:linkedin-fill"></i>
        </a>
      </li>
      

      
      <!-- GitHub -->
      <li class="navigation__item">
        <a href="https://www.github.com/phanxuanphucnd" target="_blank" title="GitHub">
          <i class="big-icon iconify-inline" data-icon="akar-icons:github-fill"></i>
        </a>
      </li>
      

      <li class="navigation__item">
        <a href="https://scholar.google.com/citations?user=ipcDPCQAAAAJ&hl=vi" title="Google Scholar" target="_blank">
          <i class="big-icon iconify-inline" data-icon="mdi:google"></i>
          <!-- <span class="label">RSS</span> -->
        </a>
      </li>

      <li class="navigation__item">
        <a href="https://www.facebook.com/phanxuanphucnd" title="Facebook" target="_blank">
          <i class="big-icon iconify-inline" data-icon="ic:outline-facebook"></i>
          <!-- <span class="label">RSS</span> -->
        </a>
      </li>
    </ul>
  </nav>
        
        <form class="search-container" onsubmit="return searchTheArchives()" >
          <input type="search" id="search-input" placeholder="Search.." autocomplete="off" style="padding-right: 40px;">
        </form>

        <hr class="panel-cover__divider panel-cover__divider--secondary">
        
        <div class="navigation-wrapper">
          <p class="panel-cover__description">I’m a AI Engineer in Vin Bigdata. And I summarize research papers in these topics:</p>
          <nav class="cover-navigation cover-navigation--primary">
            <ul class="navigation">
              
              
              <li class="navigation__item">
                <a href="/cross-lingual-lm" class="blog-button" id="cross-lingual-lm"
                onclick="activateButton(this.id)">Cross-lingual Langluage Model</a>
              </li>
              
              
              
              <li class="navigation__item">
                <a href="/language-modeling" class="blog-button" id="language-modeling"
                onclick="activateButton(this.id)">Language Modeling</a>
              </li>
              
              
              
              <li class="navigation__item">
                <a href="/machine-translation" class="blog-button" id="machine-translation"
                onclick="activateButton(this.id)">Machine Translation</a>
              </li>
              
              
              
              
              
              <li class="navigation__item">
                <a href="/multilingual-nmt" class="blog-button" id="multilingual-nmt"
                onclick="activateButton(this.id)">Multilingual NMT</a>
              </li>
              
              
              
              
              
              
            </ul>
          </nav>
        </div>
        
        <hr class="panel-cover__divider">
      </div>

    </div>

    <!-- <div class="panel-cover--overlay"></div> -->
  </div>
</header>

    <div class="content-wrapper">
      <div class="content-wrapper__inner">
        <article class="post-container post-container--single">
  <header class="post-header">
    <div class="post-meta">
      <p class="post-meta__body">
        <i class="medium-icon iconify-inline" data-icon="bi:clock-history"></i>
        <span id="reading-time">
          
          3 mins read
        </span>
      </p>
      <time datetime="2020-10-07 00:00" class="post-meta__body date">Published on arXiv on: 7 Oct 2020</time>
      
      <p class="post-meta__tags">Published by: <a href="/labs/#ByteDance AI Lab">ByteDance AI Lab</a> & <a href="/labs/#Fudan University">Fudan University</a></p>
      
    </div>
  </header>

  <section class="post">
    <h1 id=mRASP> mRASP</h1>
    <p>mRASP stands for “multilingual Random Aligned Substitution Pre-training”
which is a pre-training method for multilingual NMT models proposed by
ByteDance AI Lab in 2020 and published in their paper: “<a href="https://arxiv.org/pdf/2010.03142.pdf">Pre-training
Multilingual Neural Machine Translation by Leveraging Alignment
Information</a>”. The official code
for this paper can be found on this GitHub repository:
<a href="https://github.com/linzehui/mRASP">mRASP</a>.</p>

<p>mRASP is actually a standard Transformer-large architecture with 6-layer
encoder and 6-layer decoder. The model dimension is 1,024 on 16 heads
with replacing ReLU (Rectified Linear Unit) with GeLU (Gate Linear Unit)
as activation function on feed forward network. It also uses learned
positional embeddings.</p>

<div align="center">
    <img src="media/mRASP/image1.png" width="750" />
</div>

<p>The key idea in mRASP is its novel technique of RAS (Random Aligned
Substitution) pre-training, which brings words and phrases with similar
meanings across multiple languages closer in the representation space
achieving a a common initial multilingual NMT model that can be later
fine-tuned on any language pair.</p>

<h2 id="pre-training-via-ras">Pre-training via RAS</h2>

<p>Given a parallel sentence $\left( x^{i},\ x^{j} \right)$ in two
different languages $L_{i}$ and $L_{j}$, RAS (Random Aligned
Substitution) randomly replaces a word $x_{t}^{i}$ at index $t$ in the
source language $i$ to a another word $d_{i,k}\left( x_{t}^{i} \right)$
in a different random language $L_{k}$ using
<a href="https://phanxuanphucnd.github.io/machine-translation/MUSE">MUSE</a> dictionary
which is basically a look-up table trained in an unsupervised fashion
that is able to translate $x_{t}^{i}$ word in language $L_{i}$ to
$d_{i,k}\left( x_{t}^{i} \right)$ word in language $L_{k}$ where
$d_{i,k}$ is the dictionary translating function.</p>

<p>As we can see in the following figure, the words “singing” and “dancing”
were replaced by “chanter” and “danser” which have the same meaning in
French. For RAS, they used the top 1000 words in dictionaries and only
substituted words in source sentences. Each word is replaced with a
probability of $30\%$ according to the En-X bilingual dictionaries. And
if one word has multiple replacements, they randomly select one
substitution from all candidates To address polysemy.</p>

<div align="center">
    <img src="media/mRASP/image2.png" width="750" />
</div>

<p>With these replacement, the original bilingual pair
<span>$\left( x^{i},\ x^{j} \right)$</span> will construct a code-switched
sentence pair <span>$\left( C\left( x^{i} \right),\ x^{j} \right)$</span>.
Considering a parallel dataset <span>$\mathcal{D}_{i,j}$</span> of language
pair <span>$\left( L_{i},L_{j} \right)$</span> and <span>$\theta$</span> is the
parameter of mRASP, the pre-training loss is defined as:</p>

\[\mathcal{L}^{\text{pre}} = \sum_{i,j \in \mathcal{D}}^{}{\mathbb{E}_{\left( x^{i},x^{j} \right)\sim\mathcal{D}_{i,j}}\lbrack - \log P_{\theta}\left( x^{i} \middle| C\left( x^{j} \right) \right)\rbrack}\]

<p>In pre-training phase, mRASP was trained using Adam optimizer with and
linear decay scheduling with $\epsilon = 10^{- 8},\ \beta_{2} = 0.98$. A
warm-up step of 4000 is used. And the model was pre-trained for a total
of 150000 steps. Also, a subword vocabulary of 64,808 tokens were
created using BPE.</p>

<blockquote>
  <p><strong>Note:</strong><br />
To distinguish from different translation pairs, they simply added
language tokens. For instance, the following En→Fr sentence “<strong>How are
you? → Comment vas tu?</strong>” is transformed to “<strong>&lt;en&gt; How are you? →
&lt;fr&gt; Comment vas tu?</strong>”.</p>
</blockquote>

<h3 id="pc32">PC32</h3>

<p>PC32 stands for “Parallel Corpus 32” and this is the data created for
training mRASP containing 32 English-Centric Parallel data of 197
million pair of sentences. This dataset was collected from various
sources: <a href="https://github.com/neulab/word-embeddings-for-nmt">ted</a>,
<a href="http://www.statmt.org/">wmt</a>,
<a href="http://opus.nlpl.eu/Europarl-v8.php">europarl</a>,
<a href="https://paracrawl.eu/">paracrawl</a>,
<a href="http://opus.nlpl.eu/OpenSubtitles-v2018.php">open-subtitles</a>,
<a href="http://opus.nlpl.eu/QED-v2.0a.php">qed</a>. The following table summaries
the number of sentences of English-X where X denotes languages involved:</p>

<div align="center">
    <img src="media/mRASP/image3.png" width="1000" />
</div>

<h2 id="fine-tuning">Fine-tuning</h2>

<p>For fine-tuning, they collected 14 pairs of parallel corpus to simulate
different scenarios. The collected data was divided into four
categories:</p>

<ul>
  <li>
    <p>Extremely low resource (&lt;100K): such as En-Be (Belarusian), En-My
(Burmese), En-Af (Afrikaans), and En-Eo (Esperanto).</p>
  </li>
  <li>
    <p>Low resource(&gt;100k and &lt;1M): such as En-He (Hebrew), En-Tr
(Turkish), En-Ro (Romanian), and En-Cs (Czech).</p>
  </li>
  <li>
    <p>Medium resource (&gt;1M and &lt;10M): such as En-Ar (Arabic), En-Et
(Estonian), En-Bg (Bulgarian), and En-De (German).</p>
  </li>
  <li>
    <p>Rich resource (&gt;10M): such as En-Zh (Chinese), and En-Fr (French).</p>

    <p>mRASP model was fine-tuned on the target language pairs. They
applied a dropout rate of 0.3 for all pairs except for rich resource
with 0.1. They carefully tuned the model, setting different learning
rates and learning scheduler warm-up steps for different data scale.
For inference, we use beam-search with beam size 5.</p>
  </li>
</ul>

<h2 id="experiments">Experiments</h2>

<p>To better quantify the effectiveness of the proposed pre-training
method, they compared mRASP with a direct model which is a randomly
initialized model. The following table shows that mRASP obtains better
results on different language-pairs:</p>

<div align="center">
    <img src="media/mRASP/image4.png" width="750" />
</div>

<p>To illustrate the generalization of mRASP, they also conducted
experiments on translation directions that haven’t been seen in the
pre-training phase. The following table shows that mRASP obtains
significant gains for each category for different scales of datasets,
indicating that even trained with exotic languages, with pre-training
initialization, the model still works reasonably well.</p>

<div align="center">
    <img src="media/mRASP/image5.png" width="750" />
</div>

  </section>
</article>

  
  <br><br><br><br>
  <div id="disqus_thread"></div>
  <script type="text/javascript">
    var disqus_config = function () {
      this.page.url = 'http://localhost:4000/multilingual-nmt/mRASP';
      this.page.identifier = '/multilingual-nmt/mRASP';
    };

    (function() {
      var d = document, s = d.createElement('script');
      s.src = 'https://Phuc Phan.disqus.com/embed.js';
      s.setAttribute('data-timestamp', +new Date());
      (d.head || d.body).appendChild(s);
      })();
  </script>
  <noscript>
    Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a>
  </noscript>
  <!-- <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a> -->




      </div>
      
<footer class="footer">
  <!-- <span class="footer__copyright">&copy; 2023 Phanxuan Phuc. All rights reserved.</span> -->
  
  <!-- Adding Iconify -->
  <script src="https://code.iconify.design/2/2.0.3/iconify.min.js"></script>
  
  <!-- Adding MathJax -->
  <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      "tex2jax": {
        inlineMath: [['$','$']],
        processEscapes: true
      },
      "HTML-CSS": { linebreaks: { automatic: true } },
      "SVG": { linebreaks: { automatic: true } },
    });
  </script>
  
  <script type="text/javascript" async
    src="http://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-MML-AM_CHTML">
  </script>
  
  
  <!-- Adding main.js -->
  <script type="text/javascript" src="/js/main.js?1680763441293376118"></script>
  
  <!-- Adding Google Analytics -->
  
</footer>
    </div>
  </body>
</html>