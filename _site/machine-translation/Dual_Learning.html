<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width initial-scale=1" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  

  
  

  
  
  
  
  

  <title>Dual Learning for Machine Translation</title>
  <meta name="title" content="Dual Learning for Machine Translation">
  <meta name="description" content="Dual learning is a RL mechanism used mainly for machine translation,
proposed in 2016 by the University of Technology in China in
collaboration with Microsoft and published in this paper: “Dual
Learning for Machine
Translation”. One of the
limitation of machine translation systems is the limited parallel data
due to the the lack of human labeling. The dual-learning mechanism can
enable an NMT system to automatically learn from monolingual data (in
both the source and target languages) through a dual-learning game.

">
  <meta name="author" content="Phanxuan Phuc">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  <!-- Google / Search Engine Tags -->
  <meta itemprop="name" content="Dual Learning for Machine Translation">
  <meta itemprop="description" content="Dual learning is a RL mechanism used mainly for machine translation,
proposed in 2016 by the University of Technology in China in
collaboration with Microsoft and published in this paper: “Dual
Learning for Machine
Translation”. One of the
limitation of machine translation systems is the limited parallel data
due to the the lack of human labeling. The dual-learning mechanism can
enable an NMT system to automatically learn from monolingual data (in
both the source and target languages) through a dual-learning game.

">
  <meta itemprop="image" content="/machine-translation/media/Dual_Learning/image1.png">

  <!-- OpenGraph Meta Tags -->
  <meta property="og:url" content="http://localhost:4000">
  <meta property="og:type" content="article">
  <meta property="og:site_name" content="Phuc Phan's Blog"/>
  <meta property="og:title" content="Dual Learning for Machine Translation">
  <meta property="og:description" content="Dual learning is a RL mechanism used mainly for machine translation,
proposed in 2016 by the University of Technology in China in
collaboration with Microsoft and published in this paper: “Dual
Learning for Machine
Translation”. One of the
limitation of machine translation systems is the limited parallel data
due to the the lack of human labeling. The dual-learning mechanism can
enable an NMT system to automatically learn from monolingual data (in
both the source and target languages) through a dual-learning game.

">
  <meta property="og:image" content="/machine-translation/media/Dual_Learning/image1.png">

  <!-- Twitter Meta Tags -->
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Dual Learning for Machine Translation">
  <meta name="twitter:description" content="Dual learning is a RL mechanism used mainly for machine translation,
proposed in 2016 by the University of Technology in China in
collaboration with Microsoft and published in this paper: “Dual
Learning for Machine
Translation”. One of the
limitation of machine translation systems is the limited parallel data
due to the the lack of human labeling. The dual-learning mechanism can
enable an NMT system to automatically learn from monolingual data (in
both the source and target languages) through a dual-learning game.

">
  
  <meta name="twitter:image" content="/machine-translation/media/Dual_Learning/image1.png">

  <link rel="apple-touch-icon" sizes="57x57" href="/images/favicons/apple-touch-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/images/favicons/apple-touch-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/images/favicons/apple-touch-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/images/favicons/apple-touch-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/images/favicons/apple-touch-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/images/favicons/apple-touch-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/images/favicons/apple-touch-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/favicons/apple-touch-icon-180x180.png">
  <link rel="icon" type="image/png" href="/images/favicons/favicon-16x16.png" sizes="16x16">
  <link rel="icon" type="image/png" href="/images/favicons/favicon-32x32.png" sizes="32x32">
  <link rel="icon" type="image/png" href="/images/favicons/favicon-96x96.png" sizes="96x96">
  <link rel="icon" type="image/png" href="/images/favicons/favicon-196x196.png" sizes="196x196">
  <link rel="icon" type="image/png" href="/images/favicons/android-chrome-194x194.png" sizes="194x194">
  <link rel="icon" type="image/png" href="/images/favicons/android-chrome-512x512.png" sizes="512x512">
  <link rel="manifest" href="/images/favicons/manifest.json">
  <link rel="shortcut icon" href="/images/favicons/favicon.ico">
  <meta name="msapplication-TileColor" content="#ffc40d">
  <meta name="msapplication-TileImage" content="/images/favicons/mstile-144x144.png">
  <meta name="msapplication-square70x70logo" content="/images/favicons/mstile-70x70.png" />
  <meta name="msapplication-square150x150logo" content="/images/favicons/mstile-150x150.png" />
  <meta name="msapplication-wide310x150logo" content="/images/favicons/mstile-310x150.png" />
  <meta name="msapplication-square310x310logo" content="/images/favicons/mstile-310x310.png" />
  <meta name="theme-color" content="#ffffff">
  
  <link rel="stylesheet" href="/css/main.css?1680763441293376118">
  <link rel="canonical" href="http://localhost:4000/machine-translation/Dual_Learning">
  <link rel="alternate" type="application/rss+xml" title="Phuc Phan's Blog" href="/feed.xml">
  <script type="text/javascript" src="/js/jquery.v3.3.1.min.js"></script>
  <!-- <script type="text/javascript" src="/js/simple-jekyll-search.min.js"></script> -->
  <script type="text/javascript" src="/js/simple-blog-search.min.js"></script>
</head>

  <body>
    <span class="mobile btn-mobile-menu">
  <i class="extra-big-icon iconify-inline icon-list btn-mobile-menu__icon" data-icon="gg:menu-round"></i>
  <i class="extra-big-icon iconify-inline icon-x-circle btn-mobile-close__icon hidden" data-icon="ion:close-circle-outline"></i>
</span>

<header class="panel-cover "
  style="background-image: url(/images/forest.jpg)">
  <div class="panel-main panel-cover--overlay">

    <div class="panel-main__inner panel-inverted">
      <div class="panel-main__content">
        <img src="/images/avatar.jpg" class="user-image"
        onmouseover="this.src='/images/avatar-light.jpg';"
        onmouseout="this.src='/images/avatar.jpg';">
        <h1 class="panel-cover__title panel-title">
          <a href="/">Phanxuan Phuc</a>
        </h1>
        </a>
        <h6 class="panel-cover__title panel-subtitle">fakerphan
          <i class="medium-icon iconify-inline" data-icon="foundation:male-symbol"></i>
        </h6>
        <nav class="cover-navigation navigation--social">
    <ul class="navigation">

      
      <!-- Email -->
      <li class="navigation__item">
        <a href="mailto:phanxuanphucnd@gmail.com" target="_blank" title="Email">
          <i class="big-icon iconify-inline" data-icon="fluent:mail-copy-24-filled"></i>
        </a>
      </li>
      

      
      <!-- LinkedIn -->
      <li class="navigation__item">
        <a href="https://www.linkedin.com/in/phanxuanphucnd" target="_blank" title="LinkedIn">
          <i class="big-icon iconify-inline" data-icon="akar-icons:linkedin-fill"></i>
        </a>
      </li>
      

      
      <!-- GitHub -->
      <li class="navigation__item">
        <a href="https://www.github.com/phanxuanphucnd" target="_blank" title="GitHub">
          <i class="big-icon iconify-inline" data-icon="akar-icons:github-fill"></i>
        </a>
      </li>
      

      <li class="navigation__item">
        <a href="https://scholar.google.com/citations?user=ipcDPCQAAAAJ&hl=vi" title="Google Scholar" target="_blank">
          <i class="big-icon iconify-inline" data-icon="mdi:google"></i>
          <!-- <span class="label">RSS</span> -->
        </a>
      </li>

      <li class="navigation__item">
        <a href="https://www.facebook.com/phanxuanphucnd" title="Facebook" target="_blank">
          <i class="big-icon iconify-inline" data-icon="ic:outline-facebook"></i>
          <!-- <span class="label">RSS</span> -->
        </a>
      </li>
    </ul>
  </nav>
        
        <form class="search-container" onsubmit="return searchTheArchives()" >
          <input type="search" id="search-input" placeholder="Search.." autocomplete="off" style="padding-right: 40px;">
        </form>

        <hr class="panel-cover__divider panel-cover__divider--secondary">
        
        <div class="navigation-wrapper">
          <p class="panel-cover__description">I’m a AI Engineer in Vin Bigdata. And I summarize research papers in these topics:</p>
          <nav class="cover-navigation cover-navigation--primary">
            <ul class="navigation">
              
              
              <li class="navigation__item">
                <a href="/cross-lingual-lm" class="blog-button" id="cross-lingual-lm"
                onclick="activateButton(this.id)">Cross-lingual Langluage Model</a>
              </li>
              
              
              
              <li class="navigation__item">
                <a href="/language-modeling" class="blog-button" id="language-modeling"
                onclick="activateButton(this.id)">Language Modeling</a>
              </li>
              
              
              
              <li class="navigation__item">
                <a href="/machine-translation" class="blog-button" id="machine-translation"
                onclick="activateButton(this.id)">Machine Translation</a>
              </li>
              
              
              
              
              
              <li class="navigation__item">
                <a href="/multilingual-nmt" class="blog-button" id="multilingual-nmt"
                onclick="activateButton(this.id)">Multilingual NMT</a>
              </li>
              
              
              
              
              
              
            </ul>
          </nav>
        </div>
        
        <hr class="panel-cover__divider">
      </div>

    </div>

    <!-- <div class="panel-cover--overlay"></div> -->
  </div>
</header>

    <div class="content-wrapper">
      <div class="content-wrapper__inner">
        <article class="post-container post-container--single">
  <header class="post-header">
    <div class="post-meta">
      <p class="post-meta__body">
        <i class="medium-icon iconify-inline" data-icon="bi:clock-history"></i>
        <span id="reading-time">
          
          3 mins read
        </span>
      </p>
      <time datetime="2016-11-01 00:00" class="post-meta__body date">Published on arXiv on: 1 Nov 2016</time>
      
      <p class="post-meta__tags">Published by: <a href="/labs/#University of Science and Technology of China">University of Science and Technology of China</a> & <a href="/labs/#Peking University">Peking University</a> & <a href="/labs/#Microsoft Research">Microsoft Research</a></p>
      
    </div>
  </header>

  <section class="post">
    <h1 id=Dual Learning for Machine Translation> Dual Learning for Machine Translation</h1>
    <p>Dual learning is a RL mechanism used mainly for machine translation,
proposed in 2016 by the University of Technology in China in
collaboration with Microsoft and published in this paper: “<a href="https://arxiv.org/pdf/1611.00179.pdf">Dual
Learning for Machine
Translation</a>”. One of the
limitation of machine translation systems is the limited parallel data
due to the the lack of human labeling. The dual-learning mechanism can
enable an NMT system to automatically learn from monolingual data (in
both the source and target languages) through a dual-learning game.</p>

<p>In the dual-learning mechanism, we use one agent to represent the model
for the primal task (translating from English to French for example) and
the other agent to represent the model for the dual task (Translating
from French to English), then ask them to teach each other through a
reinforcement learning process.</p>

<p>Specifically, the dual-learning mechanism for MT can be described as the
following two-agent communication game shown in the following graph:</p>

<div align="center">
    <img src="media/Dual_Learning/image1.png" width="750" />
</div>

<p>As you can see from the graph, we have monolingual messages sampled from
corpora $D_{A}$ and $D_{B}$ in language A and B, two noisy-channel
translation models $\theta_{\text{AB}}$ and $\theta_{\text{BA}}$ , and
two language model agents $\text{LM}<em>{A}$ and $\text{LM}</em>{B}$:</p>

<ol>
  <li>
    <p>The first agent (only understands language A), samples a message
$s_{A}$ from corpora $D_{A}$ and sends it to the second agent
through the noisy channel.</p>
  </li>
  <li>
    <p>The noisy channel translation model $\theta_{\text{AB}}$ generates K
translations
<span>${\widehat{s}}<em>{1},\ {\widehat{s}}</em>{2},\ …\ {\widehat{s}}_{K}$</span>
using beam search of K beam size for the received message in
language B and sends them to the second agent.</p>

\[P\left( {\widehat{s}}_{k} \middle| s_{A};\theta_{\text{AB}} \right)\forall k \in \lbrack 1,K\rbrack\]
  </li>
  <li>
    <p>The second agent (only understands language B) receives the K
translations and compute the reward of each translated sentence
<span>${\widehat{s}}<em>{k}$ using the language model $\text{LM}</em>{B}$ </span>
and the translation model <span>$\theta_{\text{BA}}$</span>:</p>

\[r_{1,k} = \text{LM}_{B}\left( {\widehat{s}}_{k} \right)\forall k \in \lbrack 1,K\rbrack\]

\[r_{2,k} = \log\left( P\left( s \middle| {\widehat{s}}_{k};\theta_{\text{BA}} \right) \right)\forall k \in \lbrack 1,K\rbrack\]
  </li>
  <li>
    <p>Combine the two rewards using a linear combination where where
<span>$\alpha$</span> is a hyper-parameter:</p>

\[r_{k} = \alpha r_{1,k} + \left( 1 - \alpha \right)r_{2,k}\]
  </li>
  <li>
    <p>Compute the SGD and update the weights of the first noisy-channel
translation model $\theta_{\text{AB}}$ using learning rate $\gamma_{1}$:</p>

\[\nabla_{\theta_{\text{AB}}}\widehat{E}\left\lbrack r \right\rbrack = \frac{1}{K}\sum_{k = 1}^{K}\left( r_{k}.\nabla_{\theta_{\text{AB}}}\ \log\left(  P\left( {\widehat{s}}_{k} \middle| s;\theta_{\text{AB}} \right) \right) \right)\]

\[\theta_{\text{AB}} \leftarrow \theta_{\text{AB}} + \gamma_{1}\nabla_{\theta_{\text{AB}}}\widehat{E}\left\lbrack r \right\rbrack\]
  </li>
  <li>
    <p>Compute the SGD and update the weights of the second noisy-channel
translation model $\theta_{\text{BA}}$ using learning rate $\gamma_{2}$:</p>

\[\nabla_{\theta_{\text{BA}}}\widehat{E}\left\lbrack r \right\rbrack = \frac{1}{K}\sum_{k = 1}^{K}\left( \left( 1 - \alpha \right)r_{k}.\nabla_{\theta_{\text{BA}}}\ \log\left( P\left( s \middle| {\widehat{s}}_{k};\theta_{\text{BA}} \right) \right) \right)\]

\[\theta_{\text{BA}} \leftarrow \theta_{\text{BA}} + \gamma_{2}\nabla_{\theta_{\text{BA}}}\widehat{E}\left\lbrack r \right\rbrack\]
  </li>
  <li>
    <p>Assign the translated message <span>${\widehat{s}}_{k}$</span> with the
highest probability as message B <span>$s_{B}$</span> and send it back to
the first agent.</p>
  </li>
  <li>
    <p>Do the same but now using message B. And keep doing that till convergence.</p>
  </li>
</ol>

<p><strong>Notes:</strong></p>

<ul>
  <li>
    <p>The game can also be started from the second agent with an original
message in language B, and then the two agents will go through a
symmetric process and improve the two channels (translation models)
according to the feedback.</p>
  </li>
  <li>
    <p>Language models can be trained either using other resources, or just
using the monolingual data $D_{A}$ and $D_{B}$.</p>
  </li>
</ul>

<h2 id="results">Results</h2>

<p>In the paper, they trained their dual-NMT model using WMT’14 corpus
which contains 12M sentence pairs and they concatenated newstest2012 and
newstest2013 and used it as the validation set and used newstest2014 as
the testing set. Also, they used “News Crawl: articles from 2012”
provided by WMT’14 as monolingual data.</p>

<p>They constructed the vocabulary with the most common 30K words in the
parallel corpora, and out-of-vocabulary words were replaced with a
special token &lt;UNK&gt;. For monolingual corpora, they removed the
sentences containing at least one out-of-vocabulary words.</p>

<p>They compared their dual-NMT approach with two baselines: the standard
neural machine translation (NMT for short), and a NMT-model using
back-translation in two settings:</p>

<ul>
  <li>
    <p><strong>Small:</strong> They used only 10% of the parallel data for warm start.</p>
  </li>
  <li>
    <p><strong>Large:</strong> They used all parallel data.</p>

    <p>In the following results, we can see that the Dual-NMT algorithm
outperforms the baseline algorithms in all the settings despite the
fact that the two baselines for English→French and French→English
are trained separately while the dual-NMT conducts joint training.</p>
  </li>
</ul>

<div align="center">
    <img src="media/Dual_Learning/image2.png" width="750" />
</div>

  </section>
</article>

  
  <br><br><br><br>
  <div id="disqus_thread"></div>
  <script type="text/javascript">
    var disqus_config = function () {
      this.page.url = 'http://localhost:4000/machine-translation/Dual_Learning';
      this.page.identifier = '/machine-translation/Dual_Learning';
    };

    (function() {
      var d = document, s = d.createElement('script');
      s.src = 'https://Phuc Phan.disqus.com/embed.js';
      s.setAttribute('data-timestamp', +new Date());
      (d.head || d.body).appendChild(s);
      })();
  </script>
  <noscript>
    Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a>
  </noscript>
  <!-- <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a> -->




      </div>
      
<footer class="footer">
  <!-- <span class="footer__copyright">&copy; 2023 Phanxuan Phuc. All rights reserved.</span> -->
  
  <!-- Adding Iconify -->
  <script src="https://code.iconify.design/2/2.0.3/iconify.min.js"></script>
  
  <!-- Adding MathJax -->
  <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      "tex2jax": {
        inlineMath: [['$','$']],
        processEscapes: true
      },
      "HTML-CSS": { linebreaks: { automatic: true } },
      "SVG": { linebreaks: { automatic: true } },
    });
  </script>
  
  <script type="text/javascript" async
    src="http://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-MML-AM_CHTML">
  </script>
  
  
  <!-- Adding main.js -->
  <script type="text/javascript" src="/js/main.js?1680763441293376118"></script>
  
  <!-- Adding Google Analytics -->
  
</footer>
    </div>
  </body>
</html>